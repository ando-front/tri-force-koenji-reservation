# 追加機能設計・実装のためのプロンプト集

## 1. 基本プロンプトテンプレート

### 1.1 新機能追加プロンプト
```
# 機能追加プロンプト

## 背景
Tri-force Koenji施設予約システムに新しい機能を追加します。
現在のシステムは以下の技術スタックで構成されています：
- Google Apps Script (JavaScript)
- Google Spreadsheet (データ管理)
- Google Calendar (スケジュール管理)
- Materialize CSS (UI)

## 現在の機能
- 施設予約フォーム
- 重複チェック機能
- 予約データの保存
- カレンダー連携

## 追加したい機能
[具体的な機能を記述]

## 要件
### 機能要件
- [具体的な機能要件]
- [ビジネスルール]
- [制約事項]

### 非機能要件
- [性能要件]
- [可用性要件]
- [セキュリティ要件]

## 期待する回答
1. 詳細な機能設計
2. 実装コード（Google Apps Script）
3. HTMLフォーム（必要に応じて）
4. テストケース
5. 既存システムとの統合方法
```

## 2. 具体的な機能別プロンプト

### 2.1 予約キャンセル機能
```
# 予約キャンセル機能の実装

## 背景
現在のシステムには予約キャンセル機能がありません。
利用者が予約を取り消せるようにする必要があります。

## 要件
### 機能要件
- 予約一覧の表示
- 予約の選択とキャンセル
- キャンセル理由の入力
- キャンセル確認メッセージ
- カレンダーからの予約削除

### ビジネスルール
- 利用開始時刻の2時間前までキャンセル可能
- キャンセル後の予約枠は他の利用者が予約可能
- キャンセル履歴の記録
- キャンセル通知の送信

### 技術要件
- 既存のスプレッドシートスキーマとの互換性
- Google Calendar APIの使用
- セキュリティを考慮したアクセス制御

## 実装してほしい内容
1. 予約キャンセル用のWebページ
2. 予約一覧表示機能
3. キャンセル処理ロジック
4. カレンダーイベント削除
5. 通知機能
6. テストケース
```

### 2.2 予約変更機能
```
# 予約変更機能の実装

## 背景
利用者が予約の日時を変更できる機能が必要です。

## 要件
### 機能要件
- 既存予約の検索・表示
- 新しい日時の選択
- 空き状況の確認
- 変更の実行

### ビジネスルール
- 利用開始時刻の24時間前まで変更可能
- 変更先の時間枠に空きがある場合のみ変更可能
- 変更履歴の記録
- 変更通知の送信

### 技術要件
- 既存の重複チェック機能の活用
- トランザクション処理（変更の原子性）
- ロールバック機能

## 実装してほしい内容
1. 予約変更フォーム
2. 空き状況確認機能
3. 変更処理ロジック
4. 履歴管理
5. 通知機能
6. エラーハンドリング
```

### 2.3 管理者ダッシュボード
```
# 管理者ダッシュボード機能の実装

## 背景
管理者が予約状況を一覧で確認し、管理操作を行える機能が必要です。

## 要件
### 機能要件
- 予約一覧の表示（日付・施設別）
- 予約統計の表示
- 利用者情報の管理
- 施設設定の管理
- システム設定の管理

### 管理機能
- 予約の強制キャンセル
- 施設の一時停止
- 利用者のブロック
- データのエクスポート
- ログの確認

### セキュリティ要件
- 管理者認証
- 操作ログの記録
- 権限管理

## 実装してほしい内容
1. 管理者ログイン機能
2. ダッシュボード画面
3. 予約管理機能
4. 統計・レポート機能
5. 設定管理機能
6. 監査ログ機能
```

### 2.4 利用履歴機能
```
# 利用履歴機能の実装

## 背景
利用者が過去の予約履歴を確認できる機能が必要です。

## 要件
### 機能要件
- 過去の予約履歴の表示
- 期間での絞り込み
- 施設別の絞り込み
- 利用統計の表示
- CSV出力機能

### 表示項目
- 予約日時
- 施設名
- 利用時間
- ステータス（完了・キャンセル）
- 備考

### 技術要件
- 大量データの効率的な処理
- ページネーション機能
- 検索機能の最適化

## 実装してほしい内容
1. 履歴表示画面
2. 検索・絞り込み機能
3. 統計表示機能
4. エクスポート機能
5. パフォーマンス最適化
```

### 2.5 通知機能
```
# 通知機能の実装

## 背景
利用者に予約関連の通知を送信する機能が必要です。

## 要件
### 通知種類
- 予約確認通知
- キャンセル通知
- 変更通知
- リマインダー通知
- システムメンテナンス通知

### 通知方法
- メール通知
- SMS通知（オプション）
- アプリ内通知（将来対応）

### 通知設定
- 通知の有効/無効設定
- 通知タイミングの設定
- 通知テンプレートの管理

## 実装してほしい内容
1. 通知設定画面
2. 通知送信機能
3. 通知テンプレート管理
4. 通知履歴管理
5. 配信状況の確認
```

## 3. DDD実装プロンプト

### 3.1 ドメインモデル実装
```
# ドメインモデル実装プロンプト

## 背景
既存のTri-force Koenji施設予約システムをドメイン駆動設計に基づいてリファクタリングします。

## 現在の課題
- 手続き型のコードが複雑化
- ビジネスロジックとインフラストラクチャが混在
- テストの困難さ
- 機能追加時の影響範囲の大きさ

## 実装すべきドメインモデル
### 集約
- 予約集約（Reservation Aggregate）
- 施設集約（Facility Aggregate）
- 会員集約（Member Aggregate）

### 値オブジェクト
- 時間枠（TimeSlot）
- 連絡先情報（ContactInfo）
- 予約ステータス（ReservationStatus）

### ドメインサービス
- 予約可能性判定サービス
- 予約競合解決サービス

## 実装してほしい内容
1. 各集約の実装
2. 値オブジェクトの実装
3. ドメインサービスの実装
4. リポジトリインターフェース
5. アプリケーションサービス
6. 既存コードからの移行手順
```

### 3.2 アーキテクチャ改善
```
# アーキテクチャ改善プロンプト

## 目的
現在のモノリシックな構造から、保守性と拡張性を向上させたアーキテクチャへの改善

## 現在の構造
- 単一のcode.gsファイルにすべてのロジック
- HTMLファイルによるUI
- 直接的なGoogle APIs呼び出し

## 目標アーキテクチャ
- ヘキサゴナルアーキテクチャ
- CQRS パターン
- イベント駆動アーキテクチャ

## 実装してほしい内容
1. アーキテクチャの設計
2. モジュール分割
3. インターフェース定義
4. 依存性注入の実装
5. テスト戦略
6. 段階的移行計画
```

## 4. 品質保証プロンプト

### 4.1 テスト実装
```
# テスト実装プロンプト

## 背景
現在のシステムのテストカバレッジを向上させ、品質を保証します。

## テスト対象
- 予約処理ロジック
- 重複チェック機能
- データ変換処理
- 入力バリデーション
- エラーハンドリング

## テスト種類
### 単体テスト
- 各関数の動作確認
- 境界値テスト
- 異常ケーステスト

### 結合テスト
- API連携テスト
- データフロー確認
- エンドツーエンドテスト

### 性能テスト
- 負荷テスト
- レスポンス時間測定
- メモリ使用量確認

## 実装してほしい内容
1. テストフレームワークの選定
2. テストケースの作成
3. モックの実装
4. CI/CDパイプライン
5. テストレポート
```

### 4.2 パフォーマンス最適化
```
# パフォーマンス最適化プロンプト

## 現在の課題
- 大量データ処理時の速度低下
- Google Apps Scriptの実行制限
- スプレッドシートアクセスの最適化

## 最適化対象
- データ読み込み処理
- バッチ処理の実装
- キャッシュ機能
- 非同期処理

## 目標
- 処理時間の50%削減
- メモリ使用量の最適化
- 同時実行数の向上

## 実装してほしい内容
1. ボトルネックの特定
2. 最適化手法の実装
3. 性能測定機能
4. 監視機能
5. 最適化レポート
```

## 5. セキュリティ強化プロンプト

### 5.1 セキュリティ機能実装
```
# セキュリティ機能実装プロンプト

## セキュリティ要件
- 認証・認可の強化
- 入力値検証の改善
- アクセスログの記録
- 異常アクセスの検知

## 実装項目
### 認証
- OAuth 2.0の実装
- セッション管理
- 権限管理

### データ保護
- 個人情報の暗号化
- アクセス制御
- 監査ログ

### 脆弱性対策
- XSS対策
- CSRF対策
- SQLインジェクション対策

## 実装してほしい内容
1. 認証システムの実装
2. セキュリティヘッダーの設定
3. 入力値検証の強化
4. ログ機能の実装
5. セキュリティテスト
```

## 6. 運用・保守プロンプト

### 6.1 監視機能実装
```
# 監視機能実装プロンプト

## 監視要件
- システムヘルスチェック
- エラー監視
- 性能監視
- 利用状況監視

## 実装項目
### システム監視
- 稼働状況確認
- リソース使用量監視
- API応答時間監視

### アラート機能
- 閾値設定
- 通知機能
- エスカレーション

### レポート機能
- 日次レポート
- 週次レポート
- 月次レポート

## 実装してほしい内容
1. 監視ダッシュボード
2. アラート機能
3. レポート機能
4. ログ分析機能
5. 自動復旧機能
```

## 7. 使用方法

### 7.1 プロンプトの使用手順
1. **要件の明確化**: 実装したい機能を具体的に定義
2. **適切なプロンプトの選択**: 機能に応じたプロンプトテンプレートを選択
3. **カスタマイズ**: プロジェクト固有の要件に応じてプロンプトを調整
4. **実行**: AIアシスタントにプロンプトを送信
5. **結果の確認**: 生成されたコードやドキュメントを確認
6. **反復改善**: 必要に応じてプロンプトを調整し再実行

### 7.2 プロンプト最適化のコツ
- **具体的な要件**: 曖昧な表現を避け、具体的な要件を記述
- **技術的制約**: Google Apps Scriptの制限事項を明記
- **既存コードとの統合**: 既存システムとの互換性を考慮
- **テストケース**: 期待する動作を明確に定義
- **エラーハンドリング**: 想定される例外ケースを記述

---

**注意**: これらのプロンプトは、AI駆動開発を効率化するためのテンプレートです。実際の使用時には、プロジェクトの具体的な要件に応じて調整してください。

## 8. Firebase移行プロンプト

### 8.1 GAS複数アカウント問題解決
```
# GAS複数アカウント問題の解決プロンプト

## 背景
現在のTri-force Koenji施設予約システムは Google Apps Script で構築されていますが、
ブラウザで複数のGoogleアカウントにログインしている状態でアクセスすると
エラーが発生し、予約フォームが開けない問題があります。

## 問題の詳細
- 複数のGoogleアカウントでログイン時のアクセスエラー
- ユーザビリティの低下
- パブリック公開での制約

## 解決要件
### 技術要件
- 既存の機能を完全に移植
- Google Sheets / Calendar API の継続利用
- 無料または低コストでの運用
- 高い可用性と信頼性

### 移行候補
- Firebase Hosting + Cloud Functions
- Vercel + サーバーレス関数
- Netlify + Functions
- GitHub Pages + 外部API

## 実装してほしい内容
1. 最適な移行先の提案と理由
2. 詳細な移行手順
3. 既存コードの移植方法
4. 環境設定手順
5. テスト方法
6. 運用手順
```

### 8.2 Firebase具体実装
```
# Firebase移行の詳細実装プロンプト

## 背景
GAS の複数アカウント問題を解決するため、Firebase に移行します。
既存の予約システムの機能を完全に移植し、より安定したサービスを提供します。

## 現在のシステム構成
- Google Apps Script (JavaScript)
- HTML フォーム (Materialize CSS)
- Google Spreadsheet (データ管理)
- Google Calendar (スケジュール管理)

## 移行後の構成
- Frontend: Firebase Hosting
- Backend: Cloud Functions
- APIs: Google Sheets API, Calendar API
- Authentication: Service Account

## 実装要件
### フロントエンド
- 既存HTMLの完全移植
- Materialize CSS の継続利用
- レスポンシブデザインの維持
- JavaScript での API 通信

### バックエンド
- Cloud Functions での API 実装
- Google APIs との連携
- エラーハンドリング
- CORS 対応

### 機能要件
- 予約フォーム処理
- 重複チェック機能
- データ保存機能
- カレンダー登録機能
- 通知機能

## 実装してほしい内容
1. Firebase プロジェクトの初期設定手順
2. フロントエンドの完全な実装コード
3. Cloud Functions の詳細実装
4. 環境変数とセキュリティ設定
5. デプロイとテスト手順
6. 運用監視の設定
```

## 9. 使用方法
