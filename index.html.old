<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <script>
    function validateForm(e) {
      e.preventDefault();

      const formData = {
        email: document.getElementById("email").value,
        equipment: document.getElementById("equipment").value,
        name: document.getElementById("name").value,
        phone: document.getElementById("phone").value,
        startTime: document.getElementById("start-time").value,
        endTime: document.getElementById("end-time").value,
        remarks: document.getElementById("remarks").value
      };

      google.script.run
        .withSuccessHandler(function(result) {
          if (typeof result === 'string') { // エラーメッセージの場合
            document.getElementById("error-message").innerText = result;
            document.getElementById("error-message").style.display = "block";
          } else if (typeof result === 'object' && result.message) { // 完了メッセージとイベントIDの場合
              alert(result.message);
              document.getElementById("myForm").reset();
          } else {
            console.error("予期せぬ結果:", result);
            document.getElementById("error-message").innerText = "エラーが発生しました。";
            document.getElementById("error-message").style.display = "block";
          }
        })
        .withFailureHandler(function(error) {
            console.error("エラーが発生しました:", error);
            document.getElementById("error-message").innerText = "エラーが発生しました。";
            document.getElementById("error-message").style.display = "block";
        })
        .checkCalendarOverlap(formData); // フォームデータを渡すように変更
    }

    window.addEventListener('load', (event) => {
      const form = document.getElementById("myForm");
      form.addEventListener('submit', validateForm);
    });
  </script>
  <style>
    #error-message {
      color: red;
      display: none;
    }
  </style>
</head>
<body>
  <form id="myForm">
    <div id="error-message"></div>
    <input type="submit" value="送信">
  </form>
</body>
</html>